(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){},11:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"webgl",value:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}},{key:"getWebGLErrorMessage",value:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000000">here</a>.'].join("\n"),e}},{key:"addGetWebGLMessage",value:function(e){var t,n,r;t=void 0!==(e=e||{}).parent?e.parent:document.body,n=void 0!==e.id?e.id:"oldie",(r=this.getWebGLErrorMessage()).id=n,t.appendChild(r)}}])&&r(t.prototype,n),a&&r(t,a),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._loading=t.getElementById("loading"),this._saveStyle()}var t,n,r;return t=e,(n=[{key:"_saveStyle",value:function(){this._old_style=this._loading.style.display}},{key:"hideLoading",value:function(){this._saveStyle(),this._loading.style.display="none"}},{key:"showLoading",value:function(){this._loading.style.display=this._old_style}}])&&o(t.prototype,n),r&&o(t,r),e}(),s=n(0),l=n(2);n(12);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t,n,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=n,this.container=r,this.threeRenderer=new s.Wb({antialias:!0}),this.threeRenderer.setClearColor(n.fog.color),this.threeRenderer.setPixelRatio(window.devicePixelRatio),r.appendChild(this.threeRenderer.domElement),this.threeRenderer.shadowMap.enabled=!0,this.threeRenderer.shadowMap.type=s.kb,t.maxAnisotropy=this.threeRenderer.capabilities.getMaxAnisotropy(),this.updateSize(),this.threeRenderer.outputEncoding=s.Xb,this.threeRenderer.xr.enabled=!0,document.body.appendChild(l.a.createButton(this.threeRenderer)),document.addEventListener("DOMContentLoaded",(function(){return a.updateSize()}),!1),window.addEventListener("resize",(function(){return a.updateSize()}),!1)}var t,n,r;return t=e,(n=[{key:"updateSize",value:function(){this.threeRenderer.setSize(this.container.offsetWidth,this.container.offsetHeight)}},{key:"render",value:function(e,t){this.threeRenderer.render(e,t)}}])&&c(t.prototype,n),r&&c(t,r),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var a=n.domElement.width,o=n.domElement.height;this.threeCamera=new s.lb(t.camera.fov,a/o,t.camera.near,t.camera.far),this.threeCamera.position.set(t.camera.posX,t.camera.posY,t.camera.posZ),this.threeCamera.lookAt(0,0,0),this.updateSize(n),window.addEventListener("resize",(function(){return r.updateSize(n)}),!1)}var t,n,r;return t=e,(n=[{key:"updateSize",value:function(e){this.threeCamera.aspect=e.domElement.width/e.domElement.height,this.threeCamera.updateProjectionMatrix()}}])&&d(t.prototype,n),r&&d(t,r),e}(),f=n(3);function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.threeControls=new f.a(n,r),this.init(t)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this.threeControls.target.set(e.controls.target.x,e.controls.target.y,e.controls.target.z),this.threeControls.autoRotate=e.controls.autoRotate,this.threeControls.autoRotateSpeed=e.controls.autoRotateSpeed,this.threeControls.rotateSpeed=e.controls.rotateSpeed,this.threeControls.zoomSpeed=e.controls.zoomSpeed,this.threeControls.minDistance=e.controls.minDistance,this.threeControls.maxDistance=e.controls.maxDistance,this.threeControls.minPolarAngle=e.controls.minPolarAngle,this.threeControls.maxPolarAngle=e.controls.maxPolarAngle,this.threeControls.enableDamping=e.controls.enableDamping,this.threeControls.enableZoom=e.controls.enableZoom,this.threeControls.dampingFactor=e.controls.dampingFactor,this.threeControls.keys={LEFT:0,RIGHT:0,UP:0,BOTTOM:0}}}])&&v(t.prototype,n),r&&v(t,r),e}(),y=n(4),p=n.n(y);function g(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"generate",value:function(e,t,n,r){var a,o=[],i=(this._calcCenter(e),g(e));try{for(i.s();!(a=i.n()).done;){var s=a.value,l=this._generateShape(s.points,.01,r);o.push(l)}}catch(e){i.e(e)}finally{i.f()}var c,u=g(t);try{for(u.s();!(c=u.n()).done;){var d=c.value,h=this._generateShape(d,-2,r);o.push(h)}}catch(e){u.e(e)}finally{u.f()}return o}},{key:"_generateShape",value:function(e,t,n){console.log(e);var r,a=[],o=g(e);try{for(o.s();!(r=o.n()).done;){var i=r.value;a.push(new s.Sb(this._transform(i[0]),this._transform(i[1])))}}catch(e){o.e(e)}finally{o.f()}var l=new s.Bb(a),c={amount:t,bevelEnabled:!1},u=new s.v(l,c),d=new s.X(u,new s.ab({side:s.r}));return d.rotateX(Math.PI/2),d}},{key:"_calcCenter",value:function(e){var t,n=g(e);try{for(n.s();!(t=n.n()).done;){var r,a=g(t.value.points);try{for(a.s();!(r=a.n()).done;)r.value}catch(e){a.e(e)}finally{a.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"generate2",value:function(e,t){var n=this._convertToVertices(e),r=new s.k,a=new Float32Array(n);r.setAttribute("position",new s.j(a,3));var o=new s.Y({color:16711680,side:s.r}),i=new s.X(r,o);i.scale.set(.01,.01,.01);var l=this._moveToCenter(i);return[i,this._generateWallExtrude(l)]}},{key:"_generateWallExtrude",value:function(e){var t=[];t.push(new s.Sb(e.min.x,e.min.z)),t.push(new s.Sb(e.min.x,e.max.z)),t.push(new s.Sb(e.max.x,e.max.z)),t.push(new s.Sb(e.max.x,e.min.z));var n=new s.Bb(t),r=new s.v(n,{amount:-2.6,bevelEnabled:!1}),a=new s.X(r,new s.ab({side:s.r}));return a.rotateX(Math.PI/2),a.translateZ(-2),a}},{key:"_generateWall",value:function(){var e=new s.Bb(this._convertToVector(walls)),t=new s.v(e,{amount:-260}),n=new s.X(t,new s.ab({side:s.r}));n.rotateY(Math.PI/2),n.scale.set(.01,.01,.01),n.translateX(-cent.x),n.translateZ(-cent.z)}},{key:"_generatePlane",value:function(e,t){var n,r=[],a=g(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.push(o[0]),r.push(o[1])}}catch(e){a.e(e)}finally{a.f()}var i,s=g(p()(r));try{for(s.s();!(i=s.n()).done;){var l=2*i.value,c=r[l],u=r[l+1];e.push(-u),e.push(0),e.push(c)}}catch(e){s.e(e)}finally{s.f()}}},{key:"_convertToVertices",value:function(e){var t,n=[],r=g(e);try{for(r.s();!(t=r.n()).done;){var a=t.value.points;this._generatePlane(n,a)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"_convertToVector",value:function(e){var t,n=[],r=5,a=g(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(n.push(new s.Sb(o[0],o[1])),r++>8)break}}catch(e){a.e(e)}finally{a.f()}return console.log(n),n}},{key:"_moveToCenter",value:function(e){var t=(new s.g).setFromObject(e),n=t.getCenter(new s.Tb);return t.getSize(new s.Tb),console.log(t),console.log(n),e.translateX(-n.x),e.translateZ(-n.z),(new s.g).setFromObject(e)}},{key:"_transform",value:function(e){return e/100}}])&&w(t.prototype,n),r&&w(t,r),e}();function k(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s.l.enabled=!0,this._loadJSON(t.url,this._sceneImporter,t,n)}var t,n,r;return t=e,(n=[{key:"_generateFlat",value:function(e,t){return(new _).generate(e.rooms,e.doors,e.external_walls,t)}},{key:"_sceneImporter",value:function(e,t,n){t.boundingBoxes=[];var r,a=k(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.scale.set(e.size.x,e.size.y,e.size.z),o.translateX(e.translate.x),o.translateY(e.translate.y),o.translateZ(e.translate.z),o.geometry.computeBoundingBox(),o.updateMatrixWorld();var i=o.geometry.boundingBox.clone();i.applyMatrix4(o.matrixWorld),t.boundingBoxes.push(i),t.add(o)}}catch(e){a.e(e)}finally{a.f()}}},{key:"_loadJSON",value:function(e,t,n,r,a){var o=new s.w,i=this;o.load(e,(function(e){var o=i._generateFlat(JSON.parse(e.replaceAll("'",'"')),a);t(n,r,o)}),(function(e){console.log(e.loaded/e.total*100+"% loaded")}),(function(e){console.error("An error happened")}))}},{key:"_loadTexture",value:function(e,t){var n=this;(new s.Mb).load("assets/textures/floor_tiles_06_diff_1k.png ",(function(r){n._material=new s.Y({map:r,side:s.r}),n._loadJSON(e.url,n._sceneImporter,e,t,n._material)}),void 0,(function(e){console.error("An error happened.")}))}}])&&A(t.prototype,n),r&&A(t,r),e}();function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keys={};var n=new Map,r=function(e,r){t.keys[r]={down:!1,justPressed:!1},n.set(e,r)},a=function(e,r){var a=n.get(e);a&&function(e,n){var r=t.keys[e];r.justPressed=n&&!r.down,r.down=n}(a,r)};r(65,"left"),r(68,"right"),r(87,"up"),r(83,"down"),r(69,"action"),r(32,"action2"),window.addEventListener("keydown",(function(e){a(e.keyCode,!0)})),window.addEventListener("keyup",(function(e){a(e.keyCode,!1)}))}var t,n,r;return t=e,(n=[{key:"update",value:function(){for(var e=0,t=Object.values(this.keys);e<t.length;e++){var n=t[e];n.justPressed&&(n.justPressed=!1)}}}])&&C(t.prototype,n),r&&C(t,r),e}();function j(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._moveSpeed=5e-4,this._turnSpeed=4,this._avatar=t.scene,this._kForward=n,this._walk=!1;var r=new s.c(this._avatar);this._mixer=r,this._animations=this._getAnimations(this._mixer,t),this._fade_duration=.4,this._action=!1,this._action2=!1;var a=new s.h(1,.5,1),o=new s.Y({color:65280}),i=new s.X(a,o);this._boundingBox=i}var t,n,r;return t=e,(n=[{key:"update",value:function(e,t,n){this._moveSpeed;var r=this._avatar,a=this._fade_duration,o=(t.keys.up.down?1:0)+(t.keys.down.down?-1:0),i=(t.keys.left.down?1:0)+(t.keys.right.down?-1:0);if(0!==i&&r.rotateY(this._turnSpeed*i*e),0!==o){var s=o*e;r.translateOnAxis(this._kForward,s),this._walk||(this._startAnimation("walk",a),this._walk=!0),this._boundingBox.position.x=r.position.x,this._boundingBox.position.y=1,this._boundingBox.position.z=r.position.z,this._boundingBox.geometry.computeBoundingBox(),this._boundingBox.updateMatrixWorld();var l=this._boundingBox.geometry.boundingBox.clone();l.applyMatrix4(this._boundingBox.matrixWorld);var c,u=!1,d=j(n);try{for(d.s();!(c=d.n()).done;)if(c.value.intersectsBox(l)){u=!0;break}}catch(e){d.e(e)}finally{d.f()}u&&r.translateOnAxis(this._kForward,-s)}else this._walk&&(this._stopAnimation("walk",a),this._walk=!1);t.keys.action.down?!0!==this._action&&(this._startAnimation("pointing",a),this._action=!0):!0===this._action&&(this._stopAnimation("pointing",a),this._action=!1),t.keys.action2.down?!0!==this._action2&&(this._startAnimation("gesture",a),this._action2=!0):!0===this._action2&&(this._stopAnimation("gesture",a),this._action2=!1),this._mixer.update(e)}},{key:"_getAnimations",value:function(e,t){var n=t.animations,r=e.clipAction(n[6]),a=e.clipAction(n[0]),o=e.clipAction(n[8]),i=e.clipAction(n[4]),s=e.clipAction(n[10]),l=e.clipAction(n[12]),c=[];return c.pointing=r,c.gesture=a,c.startWalk=o,c.endWalk=i,c.walk=s,c.idle=l,c}},{key:"_startAnimation",value:function(e,t){this._animations[e].reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(t).play()}},{key:"_stopAnimation",value:function(e,t){this._animations[e].fadeOut(t)}}])&&E(t.prototype,n),r&&E(t,r),e}(),M=(n(9),n(1)),T=n(7),W=n(5),B=n(6);function I(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};L(this,e),this._container=t,this._config=Object.assign({fog:{color:5263440,near:8e-4},camera:{fov:60,near:.001,far:1e3,aspect:1,posX:0,posY:1.8,posZ:10.2},controls:{autoRotate:!1,autoRotateSpeed:-.5,rotateSpeed:.5,zoomSpeed:.8,minDistance:.01,maxDistance:600,minPolarAngle:Math.PI/5,maxPolarAngle:Math.PI/2,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0,enableDamping:!0,dampingFactor:.5,enableZoom:!0,target:{x:0,y:1.8,z:0}},scene:[{url:"assets/interior/generated/test.json",size:{x:1,y:1,z:1},translate:{x:0,y:0,z:0},animated:!1},{url:"assets/claudia/mixamo-1613450024492.glb",size:{x:.01,y:.01,z:.01},translate1:{x:-6,y:-.55,z:6.5},translate:{x:3,y:-.05,z:3.6},avatar:!0,animated:!1,animatedCycle:[{animation:"idle",time:2},{animation:"pointing"},{speed:.2,time:20,animation:"walk"},{animation:"gesture"}]}],isDev:!0},n),this._config.isDev&&console.log(this._config)}var t,n,r;return t=e,(n=[{key:"start",value:function(){var e=this._config;this._scene=this.createScene(e);var t=this._scene;this._renderer=new u(e,t,this._container),this._camera=new h(e,this._renderer.threeRenderer),this._controls=new m(e,this._camera.threeCamera,this._container);var n=new s.a(4210752,3);t.add(n);var r,a=I(e.scene);try{for(a.s();!(r=a.n()).done;){var o=r.value;this.loadScene(o,t)}}catch(e){a.e(e)}finally{a.f()}this._inputManager=new z,this._avatarManager=void 0}},{key:"run",value:function(){this.render()}},{key:"createScene",value:function(e){var t=new s.zb;return window.devicePixelRatio&&(e.dpr=window.devicePixelRatio),t.fog=new s.y(e.fog.color,e.fog.near),t}},{key:"render",value:function(){this._renderer.render(this._scene,this._camera.threeCamera),this._controls.threeControls.update();var e=(Date.now()-this._lastframe)/1e3;if(void 0!==this._animatedCycle){var t=this._animatedCycle[this._animatedCyclePos],n=t.time;void 0===n&&(n=this._getDuration());var r=1e3*n,a=Date.now();if(void 0!==t.speed){var o=e*t.speed;this._action_figure.translateZ(o)}a-this._lastAnimationPhase>r&&(this._getAnimation().fadeOut(.4),this._animatedCyclePos=this._animatedCyclePos+1,this._animatedCyclePos>this._animatedCycle.length-1&&(this._animatedCyclePos=0),this._lastAnimationPhase=a,this._getAnimation().reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(.4).play(),console.log(this._animatedCyclePos))}void 0!==this._mixer&&this._mixer.update(e),this._lastframe=Date.now(),this._inputManager.update(),void 0!==this._avatarManager&&this._avatarManager.update(e,this._inputManager,this._scene.boundingBoxes),requestAnimationFrame(this.render.bind(this))}},{key:"loadScene",value:function(e,t){var n=e.url.toLowerCase();n.endsWith("json")?new S(e,t):n.endsWith("gltf")||n.endsWith("glb")?this._loadGLTF(e,t):n.endsWith("fbx")?this._loadFBX(e,t):n.endsWith("vrm")?this._loadVRM(e,t):n.endsWith("bvh")?this._loadBVH(e,t):console.log("Unknown format! "+n)}},{key:"_loadBVH",value:function(e,t){var n=this;(new W.a).load(e.scene.url,(function(r){console.log(r);var a=new s.Db(r.skeleton.bones[0]);a.skeleton=r.skeleton;var o=new s.B;o.add(r.skeleton.bones[0]),t.add(n._resizeObject(e.scene.size,a)),t.add(n._resizeObject(e.scene.size,o));var i=new s.c(a);i.clipAction(r.clip).setEffectiveWeight(1).play(),n._setMixer(i)}))}},{key:"_loadVRM",value:function(e,t){(new M.a).load(e.scene.url,(function(e){B.a.from(e).then((function(e){console.log(e.meta),t.add(e.scene),console.log(e)}))}),(function(e){return console.log("Loading model...",e.loaded/e.total*100,"%")}),(function(e){return console.error(e)}))}},{key:"_fixObject",value:function(e,t){return t.translateX(e.x),t.translateY(e.y),t.translateZ(e.z),t}},{key:"_resizeObject",value:function(e,t){var n=(new s.g).setFromObject(t).getSize(new s.Tb);return Math.max(n.x,n.y,n.z),Math.max(e.x,e.y,e.z),t.scale.set(e.x,e.y,e.z),t}},{key:"_loadFBX",value:function(e,t){var n=new T.a,r=this;n.load(e.scene.url,(function(n){var a=new s.Db(n);a.visible=!0,t.add(a);var o=new s.c(n);console.log(n.animations),o.clipAction(n.animations[0]).play(),n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),t.add(r._resizeObject(e.scene.size,n)),r._setMixer(o)}))}},{key:"_loadGLTF",value:function(e,t){var n=new M.a,r=this._processScene,a=(this._searchAnimations,this);n.load(e.url,(function(n){var o=r(n.scene);if(e.avatar&&(a._avatarManager=new O(n,new s.Tb(0,0,1))),e.animated){var i=new s.Db(o);i.visible=!1,t.add(i);var l=new s.c(n.scene);a._mixer=l,a.bones=[];var c=n.animations;console.log(c);var u=l.clipAction(c[6]),d=l.clipAction(c[0]),h=l.clipAction(c[8]),f=l.clipAction(c[4]),v=l.clipAction(c[10]),m=l.clipAction(c[12]);a.durations=[],a.durations.pointing=c[6].duration,a.durations.gesture=c[0].duration,a.durations.walk=c[10].duration,a.durations.startWalk=c[8].duration,a.durations.endWalk=c[4].duration,a.durations.idle=c[12].duration,a.animations=[],a.animations.pointing=u,a.animations.gesture=d,a.animations.startWalk=h,a.animations.endWalk=f,a.animations.walk=v,a.animations.idle=m;var y=e.animatedCycle;void 0!==y&&(a._lastAnimationPhase=Date.now(),a._animatedCycle=y,a._animatedCyclePos=0,a.animations[y[a._animatedCyclePos].animation].play())}a._action_figure=a._fixObject(e.translate,a._resizeObject(e.size,o)),t.add(a._action_figure)}),void 0,(function(e){console.error(e)}))}},{key:"_searchAnimations",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._searchAnimations;void 0!==e&&void 0!==e.children&&e.children.forEach((function(e){var n=e.animations;void 0!==n&&console.log(n),t(e,t)}))}},{key:"_processScene",value:function(e){var t=e,n=(new s.g).setFromObject(t),r=n.getCenter(new s.Tb),a=n.getSize(new s.Tb),o=Math.max(a.x,a.y,a.z);return t.scale.multiplyScalar(1.8/o),n.setFromObject(t),n.getCenter(r),n.getSize(a),t.position.copy(r).multiplyScalar(-1),t.position.y+=.5*a.y,e}},{key:"_setMixer",value:function(e){this._mixer=e}},{key:"_getAnimation",value:function(){return this.animations[this._getAnimationName()]}},{key:"_getDuration",value:function(){return this.durations[this._getAnimationName()]}},{key:"_getAnimationName",value:function(){return this._animatedCycle[this._animatedCyclePos].animation}}])&&F(t.prototype,n),r&&F(t,r),e}();n(10);console.log("Start sequor.edu");var G=new a,X=new i(document);if(G.webgl()){var Y=new D(document.getElementById("appContainer"));Y.start(),X.hideLoading(),Y.run()}else X.hideLoading(),G.addGetWebGLMessage({parent:document.getElementById("appContainer"),id:"webgl-error"})},8:function(e,t,n){e.exports=n(11)}},[[8,1,2]]]);