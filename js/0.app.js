(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,n){},12:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}n.r(t);var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"webgl",value:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}},{key:"getWebGLErrorMessage",value:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000000">here</a>.'].join("\n"),e}},{key:"addGetWebGLMessage",value:function(e){var t,n,a;t=void 0!==(e=e||{}).parent?e.parent:document.body,n=void 0!==e.id?e.id:"oldie",(a=this.getWebGLErrorMessage()).id=n,t.appendChild(a)}}])&&a(t.prototype,n),r&&a(t,r),e}();function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._loading=t.getElementById("loading"),this._saveStyle()}var t,n,a;return t=e,(n=[{key:"_saveStyle",value:function(){this._old_style=this._loading.style.display}},{key:"hideLoading",value:function(){this._saveStyle(),this._loading.style.display="none"}},{key:"showLoading",value:function(){this._loading.style.display=this._old_style}}])&&o(t.prototype,n),a&&o(t,a),e}(),s=n(0),l=n(2);n(13);function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function e(t,n,a){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=n,this.container=a,this.threeRenderer=new s.Yb({antialias:!0}),this.threeRenderer.setClearColor(n.fog.color),this.threeRenderer.setPixelRatio(window.devicePixelRatio),a.appendChild(this.threeRenderer.domElement),this.threeRenderer.shadowMap.enabled=!0,this.threeRenderer.shadowMap.type=s.mb,t.maxAnisotropy=this.threeRenderer.capabilities.getMaxAnisotropy(),this.updateSize(),this.threeRenderer.outputEncoding=s.Zb,this.threeRenderer.xr.enabled=!0,document.body.appendChild(l.a.createButton(this.threeRenderer)),document.addEventListener("DOMContentLoaded",(function(){return r.updateSize()}),!1),window.addEventListener("resize",(function(){return r.updateSize()}),!1)}var t,n,a;return t=e,(n=[{key:"updateSize",value:function(){this.threeRenderer.setSize(this.container.offsetWidth,this.container.offsetHeight)}},{key:"render",value:function(e,t){this.threeRenderer.render(e,t)}}])&&u(t.prototype,n),a&&u(t,a),e}();function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var h=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.domElement.width,o=n.domElement.height;this.threeCamera=new s.nb(t.camera.fov,r/o,t.camera.near,t.camera.far),this.threeCamera.position.set(t.camera.posX,t.camera.posY,t.camera.posZ),this.threeCamera.lookAt(0,0,0),this.updateSize(n),window.addEventListener("resize",(function(){return a.updateSize(n)}),!1)}var t,n,a;return t=e,(n=[{key:"updateSize",value:function(e){this.threeCamera.aspect=e.domElement.width/e.domElement.height,this.threeCamera.updateProjectionMatrix()}}])&&d(t.prototype,n),a&&d(t,a),e}(),f=n(3);function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var m=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.threeControls=new f.a(n,a),this.init(t)}var t,n,a;return t=e,(n=[{key:"init",value:function(e){this.threeControls.target.set(e.controls.target.x,e.controls.target.y,e.controls.target.z),this.threeControls.autoRotate=e.controls.autoRotate,this.threeControls.autoRotateSpeed=e.controls.autoRotateSpeed,this.threeControls.rotateSpeed=e.controls.rotateSpeed,this.threeControls.zoomSpeed=e.controls.zoomSpeed,this.threeControls.minDistance=e.controls.minDistance,this.threeControls.maxDistance=e.controls.maxDistance,this.threeControls.minPolarAngle=e.controls.minPolarAngle,this.threeControls.maxPolarAngle=e.controls.maxPolarAngle,this.threeControls.enableDamping=e.controls.enableDamping,this.threeControls.enableZoom=e.controls.enableZoom,this.threeControls.dampingFactor=e.controls.dampingFactor,this.threeControls.keys={LEFT:0,RIGHT:0,UP:0,BOTTOM:0}}}])&&v(t.prototype,n),a&&v(t,a),e}(),y=n(4);function p(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initSky(t)}var t,n,a;return t=e,(n=[{key:"_initSky",value:function(e){var t=new y.a;t.scale.setScalar(45e4),e.add(t);var n=new s.Vb,a=10,r=3,o=.005,i=.7,l=.49,u=.25,c=t.material.uniforms;c.turbidity.value=a,c.rayleigh.value=r,c.mieCoefficient.value=o,c.mieDirectionalG.value=i;var d=Math.PI*(l-.5),h=2*Math.PI*(u-.5);n.x=Math.cos(h),n.y=Math.sin(h)*Math.sin(d),n.z=Math.sin(h)*Math.cos(d),c.sunPosition.value.copy(n)}}])&&p(t.prototype,n),a&&p(t,a),e}(),w=n(5),b=n.n(w);function _(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var A=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"generate",value:function(e,t,n,a){var r,o=[],i=(this._calcCenter(e),_(e));try{for(i.s();!(r=i.n()).done;){var s=r.value,l=this._generateShape(s.points,.01,a.getTexture("floor"));o.push(l)}}catch(e){i.e(e)}finally{i.f()}var u,c=_(t);try{for(c.s();!(u=c.n()).done;){var d=u.value,h=this._generateShape(d,-2,a.getTexture("door"));o.push(h)}}catch(e){c.e(e)}finally{c.f()}return o}},{key:"_generateShape",value:function(e,t,n){var a,r=[],o=_(e);try{for(o.s();!(a=o.n()).done;){var i=a.value;r.push(new s.Ub(this._transform(i[0]),this._transform(i[1])))}}catch(e){o.e(e)}finally{o.f()}var l=new s.Db(r),u={amount:t,bevelEnabled:!1},c=new s.w(l,u),d=new s.Z(c,new s.bb({map:n,side:s.s}));return d.receiveShadow=!0,d.rotateX(Math.PI/2),d}},{key:"_calcCenter",value:function(e){var t,n=_(e);try{for(n.s();!(t=n.n()).done;){var a,r=_(t.value.points);try{for(r.s();!(a=r.n()).done;)a.value}catch(e){r.e(e)}finally{r.f()}}}catch(e){n.e(e)}finally{n.f()}}},{key:"generate2",value:function(e,t){var n=this._convertToVertices(e),a=new s.l,r=new Float32Array(n);a.setAttribute("position",new s.k(r,3));var o=new s.ab({color:16711680,side:s.s}),i=new s.Z(a,o);i.scale.set(.01,.01,.01);var l=this._moveToCenter(i);return[i,this._generateWallExtrude(l)]}},{key:"_generateWallExtrude",value:function(e){var t=[];t.push(new s.Ub(e.min.x,e.min.z)),t.push(new s.Ub(e.min.x,e.max.z)),t.push(new s.Ub(e.max.x,e.max.z)),t.push(new s.Ub(e.max.x,e.min.z));var n=new s.Db(t),a=new s.w(n,{amount:-2.6,bevelEnabled:!1}),r=new s.Z(a,new s.cb({side:s.s}));return r.rotateX(Math.PI/2),r.translateZ(-2),r}},{key:"_generateWall",value:function(){var e=new s.Db(this._convertToVector(walls)),t=new s.w(e,{amount:-260}),n=new s.Z(t,new s.cb({side:s.s}));n.rotateY(Math.PI/2),n.scale.set(.01,.01,.01),n.translateX(-cent.x),n.translateZ(-cent.z)}},{key:"_generatePlane",value:function(e,t){var n,a=[],r=_(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;a.push(o[0]),a.push(o[1])}}catch(e){r.e(e)}finally{r.f()}var i,s=_(b()(a));try{for(s.s();!(i=s.n()).done;){var l=2*i.value,u=a[l],c=a[l+1];e.push(-c),e.push(0),e.push(u)}}catch(e){s.e(e)}finally{s.f()}}},{key:"_convertToVertices",value:function(e){var t,n=[],a=_(e);try{for(a.s();!(t=a.n()).done;){var r=t.value.points;this._generatePlane(n,r)}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"_convertToVector",value:function(e){var t,n=[],a=5,r=_(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(n.push(new s.Ub(o[0],o[1])),a++>8)break}}catch(e){r.e(e)}finally{r.f()}return console.log(n),n}},{key:"_moveToCenter",value:function(e){var t=(new s.g).setFromObject(e),n=t.getCenter(new s.Vb);return t.getSize(new s.Vb),console.log(t),console.log(n),e.translateX(-n.x),e.translateZ(-n.z),(new s.g).setFromObject(e)}},{key:"_transform",value:function(e){return e/100}}])&&x(t.prototype,n),a&&x(t,a),e}();function S(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textures={},this._loadTextures(this.textures)}var t,n,a;return t=e,(n=[{key:"_loadTextures",value:function(e){var t=new s.Ob,n=t.load("assets/textures/floor_tiles_06_diff_1k.png");n.wrapS=n.wrapT=s.Ab,n.repeat.set(2,2),e.floor=n;var a=t.load("assets/textures/door_texture_3d_model_c4d_max_obj_fbx_ma_lwo_3ds_3dm_stl_963788_o.jpg");a.wrapS=a.wrapT=s.Ab,a.repeat.set(1,1),e.door=a}},{key:"getTexture",value:function(e){return this.textures[e]}}])&&S(t.prototype,n),a&&S(t,a),e}();function z(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function P(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var M=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s.m.enabled=!0;var a=new C;this._loadJSON(t.url,this._sceneImporter,t,n,a)}var t,n,a;return t=e,(n=[{key:"_generateFlat",value:function(e,t){return(new A).generate(e.rooms,e.doors,e.external_walls,t)}},{key:"_sceneImporter",value:function(e,t,n){t.boundingBoxes=[];var a,r=z(n);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.scale.set(e.size.x,e.size.y,e.size.z),o.translateX(e.translate.x),o.translateY(e.translate.y),o.translateZ(e.translate.z),o.geometry.computeBoundingBox(),o.updateMatrixWorld();var i=o.geometry.boundingBox.clone();i.applyMatrix4(o.matrixWorld),t.boundingBoxes.push(i),t.add(o)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_loadJSON",value:function(e,t,n,a,r){var o=new s.x,i=this;o.load(e,(function(e){var o=i._generateFlat(JSON.parse(e.replaceAll("'",'"')),r);t(n,a,o)}),(function(e){console.log(e.loaded/e.total*100+"% loaded")}),(function(e){console.error("An error happened")}))}},{key:"_loadTexture",value:function(e,t){var n=this;(new s.Ob).load("assets/textures/floor_tiles_06_diff_1k.png ",(function(a){n._material=new s.ab({map:a,side:s.s}),n._loadJSON(e.url,n._sceneImporter,e,t,n._material)}),void 0,(function(e){console.error("An error happened.")}))}}])&&P(t.prototype,n),a&&P(t,a),e}();function O(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var E=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keys={};var n=new Map,a=function(e,a){t.keys[a]={down:!1,justPressed:!1},n.set(e,a)},r=function(e,a){var r=n.get(e);r&&function(e,n){var a=t.keys[e];a.justPressed=n&&!a.down,a.down=n}(r,a)};a(65,"left"),a(68,"right"),a(87,"up"),a(83,"down"),a(69,"action"),a(32,"action2"),a(70,"speak"),window.addEventListener("keydown",(function(e){r(e.keyCode,!0)})),window.addEventListener("keyup",(function(e){r(e.keyCode,!1)}))}var t,n,a;return t=e,(n=[{key:"update",value:function(){for(var e=0,t=Object.values(this.keys);e<t.length;e++){var n=t[e];n.justPressed&&(n.justPressed=!1)}}}])&&O(t.prototype,n),a&&O(t,a),e}();function T(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var B=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._moveSpeed=.05/60,this._turnSpeed=4,this._avatar=t.scene,this._kForward=n,this._walk=!1,this._avatar.castShadow=!0;var a=new s.c(this._avatar);this._mixer=a,this._fade_duration=.4,this._animations=this._getAnimations(this._mixer,t),this._startAnimation("idle",this._fade_duration),this._action=!1,this._action2=!1;var r=new s.i(.7,.5,.5),o=new s.ab({color:65280}),i=new s.Z(r,o);this._boundingBox=i}var t,n,a;return t=e,(n=[{key:"update",value:function(e,t,n){this._moveSpeed;var a=this._avatar,r=this._fade_duration,o=(t.keys.up.down?1:0)+(t.keys.down.down?-1:0),i=(t.keys.left.down?1:0)+(t.keys.right.down?-1:0);if(0!==i&&a.rotateY(this._turnSpeed*i*e),0!==o){var s=o*e;a.translateOnAxis(this._kForward,s),this._walk||(this._stopAnimation("idle",r),this._startAnimation("walk",r),this._walk=!0),this._boundingBox.position.x=a.position.x,this._boundingBox.position.y=1,this._boundingBox.position.z=a.position.z,this._boundingBox.geometry.computeBoundingBox(),this._boundingBox.updateMatrixWorld();var l=this._boundingBox.geometry.boundingBox.clone();l.applyMatrix4(this._boundingBox.matrixWorld);var u,c=!1,d=T(n);try{for(d.s();!(u=d.n()).done;)if(u.value.intersectsBox(l)){c=!0;break}}catch(e){d.e(e)}finally{d.f()}c&&a.translateOnAxis(this._kForward,-s)}else this._walk&&(this._stopAnimation("walk",r),this._startAnimation("idle",this._fade_duration),this._walk=!1);t.keys.speak.down&&this._startAnimation("jaw",.01),t.keys.action.down?!0!==this._action&&(this._stopAnimation("idle",r),this._startAnimation("pointing",r),this._action=!0):!0===this._action&&(this._startAnimation("idle",r),this._stopAnimation("pointing",r),this._action=!1),t.keys.action2.down?!0!==this._action2&&(this._stopAnimation("idle",r),this._startAnimation("gesture",r),this._action2=!0):!0===this._action2&&(this._startAnimation("idle",r),this._stopAnimation("gesture",r),this._action2=!1),this._mixer.update(e)}},{key:"_getAnimations",value:function(e,t){var n=t.animations,a=e.clipAction(n[6]),r=e.clipAction(n[0]),o=e.clipAction(n[8]),i=e.clipAction(n[4]),l=e.clipAction(n[10]),u=e.clipAction(n[12]),c=[];c.pointing=a,c.gesture=r,c.startWalk=o,c.endWalk=i,c.walk=l,c.idle=u;var d=e.clipAction(this._makeJaw());return d.setLoop(s.T,2),c.jaw=d,c}},{key:"_startAnimation",value:function(e,t){this._animations[e].reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(t).play()}},{key:"_stopAnimation",value:function(e,t){this._animations[e].fadeOut(t)}},{key:"_makeJaw",value:function(){var e=new s.Vb(0,0,1),t=new s.tb(0,0,-.8664570450782776,.4992516338825226),n=(new s.tb).setFromAxisAngle(e,-Math.PI+Math.PI/5),a=new s.ub("jaw.quaternion",[0,1,2],[t.x,t.y,t.z,t.w,n.x,n.y,n.z,n.w,t.x,t.y,t.z,t.w]);return new s.b("Action",.5,[a])}}])&&I(t.prototype,n),a&&I(t,a),e}(),F=(n(10),n(1)),R=n(8),L=n(6),D=n(7);function G(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var X=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};V(this,e),this._container=t,this._config=Object.assign({fog:{color:5263440,near:8e-4},camera:{fov:60,near:.001,far:1e3,aspect:1,posX:0,posY:1.8,posZ:10.2},controls:{autoRotate:!1,autoRotateSpeed:-.5,rotateSpeed:.5,zoomSpeed:.8,minDistance:.01,maxDistance:600,minPolarAngle:Math.PI/5,maxPolarAngle:Math.PI/2,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0,enableDamping:!0,dampingFactor:.5,enableZoom:!0,target:{x:0,y:1.8,z:0}},scene:[{url:"assets/interior/generated/test.json",size:{x:1,y:1,z:1},translate:{x:0,y:0,z:0},animated:!1},{url:"assets/claudia/mixamo-1613450024492.glb",size:{x:.01,y:.01,z:.01},translate1:{x:-6,y:-.55,z:6.5},translate:{x:3,y:-.05,z:3.6},avatar:!0,animated:!1,animatedCycle:[{animation:"idle",time:2},{animation:"pointing"},{speed:.2,time:20,animation:"walk"},{animation:"gesture"}]}],isDev:!0},n),this._config.isDev&&console.log(this._config)}var t,n,a;return t=e,(n=[{key:"start",value:function(){var e=this._config;this._scene=this.createScene(e);var t=this._scene;this._renderer=new c(e,t,this._container),this._camera=new h(e,this._renderer.threeRenderer),this._controls=new m(e,this._camera.threeCamera,this._container);var n=new s.a(4210752,3);t.add(n);var a,r=G(e.scene);try{for(r.s();!(a=r.n()).done;){var o=a.value;this.loadScene(o,t)}}catch(e){r.e(e)}finally{r.f()}new g(t),this._inputManager=new E,this._avatarManager=void 0}},{key:"run",value:function(){this.render()}},{key:"createScene",value:function(e){var t=new s.Bb;return window.devicePixelRatio&&(e.dpr=window.devicePixelRatio),t.fog=new s.z(e.fog.color,e.fog.near),t}},{key:"render",value:function(){this._renderer.render(this._scene,this._camera.threeCamera),this._controls.threeControls.update();var e=(Date.now()-this._lastframe)/1e3;if(void 0!==this._animatedCycle){var t=this._animatedCycle[this._animatedCyclePos],n=t.time;void 0===n&&(n=this._getDuration());var a=1e3*n,r=Date.now();if(void 0!==t.speed){var o=e*t.speed;this._action_figure.translateZ(o)}r-this._lastAnimationPhase>a&&(this._getAnimation().fadeOut(.4),this._animatedCyclePos=this._animatedCyclePos+1,this._animatedCyclePos>this._animatedCycle.length-1&&(this._animatedCyclePos=0),this._lastAnimationPhase=r,this._getAnimation().reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(.4).play(),console.log(this._animatedCyclePos))}void 0!==this._mixer&&this._mixer.update(e),this._lastframe=Date.now(),this._inputManager.update(),void 0!==this._avatarManager&&this._avatarManager.update(e,this._inputManager,this._scene.boundingBoxes),requestAnimationFrame(this.render.bind(this))}},{key:"loadScene",value:function(e,t){var n=e.url.toLowerCase();n.endsWith("json")?new M(e,t):n.endsWith("gltf")||n.endsWith("glb")?this._loadGLTF(e,t):n.endsWith("fbx")?this._loadFBX(e,t):n.endsWith("vrm")?this._loadVRM(e,t):n.endsWith("bvh")?this._loadBVH(e,t):console.log("Unknown format! "+n)}},{key:"_loadBVH",value:function(e,t){var n=this;(new L.a).load(e.scene.url,(function(a){console.log(a);var r=new s.Fb(a.skeleton.bones[0]);r.skeleton=a.skeleton;var o=new s.C;o.add(a.skeleton.bones[0]),t.add(n._resizeObject(e.scene.size,r)),t.add(n._resizeObject(e.scene.size,o));var i=new s.c(r);i.clipAction(a.clip).setEffectiveWeight(1).play(),n._setMixer(i)}))}},{key:"_loadVRM",value:function(e,t){(new F.a).load(e.scene.url,(function(e){D.a.from(e).then((function(e){console.log(e.meta),t.add(e.scene),console.log(e)}))}),(function(e){return console.log("Loading model...",e.loaded/e.total*100,"%")}),(function(e){return console.error(e)}))}},{key:"_fixObject",value:function(e,t){return t.translateX(e.x),t.translateY(e.y),t.translateZ(e.z),t}},{key:"_resizeObject",value:function(e,t){var n=(new s.g).setFromObject(t).getSize(new s.Vb);return Math.max(n.x,n.y,n.z),Math.max(e.x,e.y,e.z),t.scale.set(e.x,e.y,e.z),t}},{key:"_loadFBX",value:function(e,t){var n=new R.a,a=this;n.load(e.scene.url,(function(n){var r=new s.Fb(n);r.visible=!0,t.add(r);var o=new s.c(n);console.log(n.animations),o.clipAction(n.animations[0]).play(),n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),t.add(a._resizeObject(e.scene.size,n)),a._setMixer(o)}))}},{key:"_loadGLTF",value:function(e,t){var n=new F.a,a=this._processScene,r=(this._searchAnimations,this);n.load(e.url,(function(n){var o=a(n.scene);if(e.avatar){var i=new s.Fb(o);console.log(i),r._avatarManager=new B(n,new s.Vb(0,0,1))}if(e.animated){var l=new s.Fb(o);l.visible=!1,t.add(l),console.log(l);var u=new s.c(n.scene);r._mixer=u,r.bones=[];var c=n.animations;console.log(c);var d=u.clipAction(c[6]),h=u.clipAction(c[0]),f=u.clipAction(c[8]),v=u.clipAction(c[4]),m=u.clipAction(c[10]),y=u.clipAction(c[12]);r.durations=[],r.durations.pointing=c[6].duration,r.durations.gesture=c[0].duration,r.durations.walk=c[10].duration,r.durations.startWalk=c[8].duration,r.durations.endWalk=c[4].duration,r.durations.idle=c[12].duration,r.animations=[],r.animations.pointing=d,r.animations.gesture=h,r.animations.startWalk=f,r.animations.endWalk=v,r.animations.walk=m,r.animations.idle=y;var p=e.animatedCycle;void 0!==p&&(r._lastAnimationPhase=Date.now(),r._animatedCycle=p,r._animatedCyclePos=0,r.animations[p[r._animatedCyclePos].animation].play())}r._action_figure=r._fixObject(e.translate,r._resizeObject(e.size,o)),t.add(r._action_figure)}),void 0,(function(e){console.error(e)}))}},{key:"_searchAnimations",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._searchAnimations;void 0!==e&&void 0!==e.children&&e.children.forEach((function(e){var n=e.animations;void 0!==n&&console.log(n),t(e,t)}))}},{key:"_processScene",value:function(e){var t=e,n=(new s.g).setFromObject(t),a=n.getCenter(new s.Vb),r=n.getSize(new s.Vb),o=Math.max(r.x,r.y,r.z);return t.scale.multiplyScalar(1.8/o),n.setFromObject(t),n.getCenter(a),n.getSize(r),t.position.copy(a).multiplyScalar(-1),t.position.y+=.5*r.y,e}},{key:"_setMixer",value:function(e){this._mixer=e}},{key:"_getAnimation",value:function(){return this.animations[this._getAnimationName()]}},{key:"_getDuration",value:function(){return this.durations[this._getAnimationName()]}},{key:"_getAnimationName",value:function(){return this._animatedCycle[this._animatedCyclePos].animation}}])&&U(t.prototype,n),a&&U(t,a),e}();n(11);console.log("Start sequor.edu");var Y=new r,J=new i(document);if(Y.webgl()){var N=new X(document.getElementById("appContainer"));N.start(),J.hideLoading(),N.run()}else J.hideLoading(),Y.addGetWebGLMessage({parent:document.getElementById("appContainer"),id:"webgl-error"})},9:function(e,t,n){e.exports=n(12)}},[[9,1,2]]]);